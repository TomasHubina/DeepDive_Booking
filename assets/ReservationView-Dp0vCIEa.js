import{_ as C,B as b,c as l,a as t,j as p,t as i,g as n,k,w as d,v as h,F as S,h as c,e as m,b as f,f as D,r as y,u as g,o as u}from"./index-DnMmg2eV.js";import{u as R}from"./reservationStore-CYr3xhX2.js";const V={name:"ReservationView",components:{BaseButton:b},data(){return{coursesStore:null,reservationStore:null,reservationSubmitted:!1,submittedReservation:null,formData:{courseId:null,studentName:"",studentEmail:"",studentPhone:"",preferredDate:"",participants:1,notes:""}}},computed:{availableCourses(){return this.coursesStore?.courses||[]},selectedCourse(){return this.formData.courseId?this.coursesStore?.getCourseById(this.formData.courseId):null},totalPrice(){return this.selectedCourse?this.selectedCourse.price*this.formData.participants:0},minDate(){return new Date().toISOString().split("T")[0]},isFormValid(){return this.formData.courseId&&this.formData.studentName.trim()!==""&&this.formData.studentEmail.trim()!==""&&this.formData.studentPhone.trim()!==""&&this.formData.preferredDate!==""&&this.formData.participants>0}},created(){this.coursesStore=g(),this.reservationStore=R();const a=this.$route.params.courseId;a&&(this.formData.courseId=parseInt(a))},methods:{handleCourseChange(){this.selectedCourse&&this.formData.participants>this.selectedCourse.maxStudents&&(this.formData.participants=this.selectedCourse.maxStudents)},submitReservation(){try{this.reservationStore.updateReservationField("courseId",this.formData.courseId),this.reservationStore.updateReservationField("studentName",this.formData.studentName),this.reservationStore.updateReservationField("studentEmail",this.formData.studentEmail),this.reservationStore.updateReservationField("studentPhone",this.formData.studentPhone),this.reservationStore.updateReservationField("preferredDate",this.formData.preferredDate),this.reservationStore.updateReservationField("participants",this.formData.participants),this.reservationStore.updateReservationField("notes",this.formData.notes);const a=this.reservationStore.submitReservation();this.submittedReservation=a,this.reservationSubmitted=!0,window.scrollTo({top:0,behavior:"smooth"})}catch(a){console.error("Error submitting reservation:",a),alert("Nastala chyba pri odosielaní rezervácie. Skúste to prosím znova.")}},cancelReservation(){this.$router.push("/courses")},makeAnotherReservation(){this.reservationSubmitted=!1,this.submittedReservation=null,this.formData={courseId:null,studentName:"",studentEmail:"",studentPhone:"",preferredDate:"",participants:1,notes:""}},goToCourses(){this.$router.push("/courses")},formatDate(a){return new Date(a).toLocaleDateString("sk-SK",{year:"numeric",month:"long",day:"numeric"})}}},z={class:"reservation-view"},x={class:"container"},I={key:0,class:"reservation-form-container"},N={key:0,class:"course-summary"},P={class:"course-info"},w={class:"course-details"},B={key:0,class:"form-group"},F=["value"],E={class:"form-group"},X={class:"form-group"},T={class:"form-group"},M={class:"form-group"},U=["min"],q={class:"form-group"},j=["max"],A={key:0},K={class:"form-group"},L={key:1,class:"total-price"},O={class:"form-actions"},Z={key:1,class:"confirmation"},G={class:"confirmation-details"},H={class:"confirmation-actions"};function J(a,e,Q,W,o,r){const v=y("BaseButton");return u(),l("div",z,[t("div",x,[e[35]||(e[35]=t("h1",null,"Rezervácia kurzu",-1)),o.reservationSubmitted?(u(),l("div",Z,[e[32]||(e[32]=t("div",{class:"confirmation-icon"},"✓",-1)),e[33]||(e[33]=t("h2",null,"Rezervácia bola úspešne odoslaná!",-1)),e[34]||(e[34]=t("p",null,"Ďakujeme za vašu rezerváciu. Na váš email sme odoslali potvrdenie.",-1)),t("div",G,[e[29]||(e[29]=t("h3",null,"Detaily rezervácie:",-1)),t("p",null,[e[25]||(e[25]=t("strong",null,"Kurz:",-1)),n(" "+i(o.submittedReservation.courseName),1)]),t("p",null,[e[26]||(e[26]=t("strong",null,"Dátum:",-1)),n(" "+i(r.formatDate(o.submittedReservation.preferredDate)),1)]),t("p",null,[e[27]||(e[27]=t("strong",null,"Počet účastníkov:",-1)),n(" "+i(o.submittedReservation.participants),1)]),t("p",null,[e[28]||(e[28]=t("strong",null,"Celková cena:",-1)),n(" "+i(o.submittedReservation.totalPrice)+"€",1)])]),t("div",H,[f(v,{onClick:r.goToCourses},{default:D(()=>[...e[30]||(e[30]=[n(" Späť na kurzy ",-1)])]),_:1},8,["onClick"]),f(v,{variant:"outline",onClick:r.makeAnotherReservation},{default:D(()=>[...e[31]||(e[31]=[n(" Vytvoriť ďalšiu rezerváciu ",-1)])]),_:1},8,["onClick"])])])):(u(),l("div",I,[r.selectedCourse?(u(),l("div",N,[e[12]||(e[12]=t("h2",null,"Vybraný kurz",-1)),t("div",P,[t("h3",null,i(r.selectedCourse.name),1),t("p",null,i(r.selectedCourse.description),1),t("div",w,[t("span",null,[e[9]||(e[9]=t("strong",null,"Trvanie:",-1)),n(" "+i(r.selectedCourse.duration),1)]),t("span",null,[e[10]||(e[10]=t("strong",null,"Cena:",-1)),n(" "+i(r.selectedCourse.price)+"€",1)]),t("span",null,[e[11]||(e[11]=t("strong",null,"Max. študentov:",-1)),n(" "+i(r.selectedCourse.maxStudents),1)])])])])):p("",!0),t("form",{onSubmit:e[8]||(e[8]=k((...s)=>r.submitReservation&&r.submitReservation(...s),["prevent"])),class:"reservation-form"},[e[24]||(e[24]=t("h2",null,"Vaše údaje",-1)),r.selectedCourse?p("",!0):(u(),l("div",B,[e[14]||(e[14]=t("label",{for:"course-select"},"Vyberte kurz *",-1)),d(t("select",{id:"course-select","onUpdate:modelValue":e[0]||(e[0]=s=>o.formData.courseId=s),required:"",onChange:e[1]||(e[1]=(...s)=>r.handleCourseChange&&r.handleCourseChange(...s))},[e[13]||(e[13]=t("option",{value:""},"-- Vyberte kurz --",-1)),(u(!0),l(S,null,c(r.availableCourses,s=>(u(),l("option",{key:s.id,value:s.id},i(s.name)+" ("+i(s.price)+"€) ",9,F))),128))],544),[[h,o.formData.courseId]])])),t("div",E,[e[15]||(e[15]=t("label",{for:"student-name"},"Meno a priezvisko *",-1)),d(t("input",{id:"student-name",type:"text","onUpdate:modelValue":e[2]||(e[2]=s=>o.formData.studentName=s),required:"",placeholder:"Vaše meno a priezvisko"},null,512),[[m,o.formData.studentName]])]),t("div",X,[e[16]||(e[16]=t("label",{for:"student-email"},"Email *",-1)),d(t("input",{id:"student-email",type:"email","onUpdate:modelValue":e[3]||(e[3]=s=>o.formData.studentEmail=s),required:"",placeholder:"vas@email.com"},null,512),[[m,o.formData.studentEmail]])]),t("div",T,[e[17]||(e[17]=t("label",{for:"student-phone"},"Telefónne číslo *",-1)),d(t("input",{id:"student-phone",type:"tel","onUpdate:modelValue":e[4]||(e[4]=s=>o.formData.studentPhone=s),required:"",placeholder:"+421 XXX XXX XXX"},null,512),[[m,o.formData.studentPhone]])]),t("div",M,[e[18]||(e[18]=t("label",{for:"preferred-date"},"Preferovaný dátum začiatku *",-1)),d(t("input",{id:"preferred-date",type:"date","onUpdate:modelValue":e[5]||(e[5]=s=>o.formData.preferredDate=s),required:"",min:r.minDate},null,8,U),[[m,o.formData.preferredDate]])]),t("div",q,[e[19]||(e[19]=t("label",{for:"participants"},"Počet účastníkov *",-1)),d(t("input",{id:"participants",type:"number","onUpdate:modelValue":e[6]||(e[6]=s=>o.formData.participants=s),required:"",min:"1",max:r.selectedCourse?.maxStudents||10},null,8,j),[[m,o.formData.participants,void 0,{number:!0}]]),r.selectedCourse?(u(),l("small",A," Maximum: "+i(r.selectedCourse.maxStudents)+" účastníkov ",1)):p("",!0)]),t("div",K,[e[20]||(e[20]=t("label",{for:"notes"},"Poznámka (voliteľné)",-1)),d(t("textarea",{id:"notes","onUpdate:modelValue":e[7]||(e[7]=s=>o.formData.notes=s),rows:"4",placeholder:"Máte nejaké špeciálne požiadavky alebo otázky?"},null,512),[[m,o.formData.notes]])]),r.selectedCourse?(u(),l("div",L,[e[21]||(e[21]=t("strong",null,"Celková cena:",-1)),t("span",null,i(r.totalPrice)+"€",1)])):p("",!0),t("div",O,[f(v,{type:"submit",disabled:!r.isFormValid},{default:D(()=>[...e[22]||(e[22]=[n(" Odoslať rezerváciu ",-1)])]),_:1},8,["disabled"]),f(v,{variant:"outline",onClick:r.cancelReservation},{default:D(()=>[...e[23]||(e[23]=[n(" Zrušiť ",-1)])]),_:1},8,["onClick"])])],32)]))])])}const $=C(V,[["render",J],["__scopeId","data-v-28b2fb35"]]);export{$ as default};
